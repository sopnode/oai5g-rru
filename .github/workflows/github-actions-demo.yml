name: GitHub Actions Demo
run-name: ${{ github.actor }} is testing out GitHub Actions üöÄ
on: [push]
jobs:
  Explore-GitHub-Actions:
    runs-on: self-hosted
    env: 
      WORK: "/home/github-runner/actions-runner/_work"
      OAI5G: "/home/github-runner/actions-runner/_work/test-oai5g-rru"
    steps:
      - name: Retrieve the prepare-demo-oai.sh script to set up the oai5g-rru demo script
        run: |
          echo "recreate empty directory test-oai5g-rru "
          rm -rf test-oai5g-rru; mkdir test-oai5g-rru
          cd test-oai5g-rru
          echo "retrieve prepare-demo-oai.sh script"
          wget https://raw.githubusercontent.com/sopnode/oai5g-rru/develop-r2lab/testing/prepare-demo-oai.sh
          chmod a+x prepare-demo-oai.sh
          echo "configure oai5g-rru demo script"
          $OAI5G/prepare-demo-oai.sh
          echo "retrieve local r2lab-setup.sh script"
          cp $WORK/local-scripts/run.sh .
          echo "Check/book R2lab slice"
          $OAI5G/run.sh get-slice
          echo "RRU setup"
          $OAI5G/run.sh init-rru
          echo "UE setup"
          $OAI5G/run.sh init-ue
          echo "Run the oai5g-rru demo"
          $OAI5G/demo-oai.sh start
          echo "Sleep 10s"; sleep 10
          echo "Trigger UE cx"
          $OAI5G/run.sh start-ue || true
          echo "Sleep 1mn"; sleep 60
          echo "Stop the oai5g-rru demo"
          $OAI5G/demo-oai.sh stop
          echo "Free R2lab resources"
          $OAI5G/run.sh all-off
      - run: echo "üçè This job's status is ${{ job.status }}."
      
